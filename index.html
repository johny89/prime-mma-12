
<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Prime MMA 12 - Transmisja</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #111;
      color: white;
      padding: 20px;
      text-align: center;
    }
    .stream-box {
      background-color: black;
      height: 400px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      position: relative;
    }
  </style>
</head>
<body>
<div id="prime-mma-stream" style="font-family: Arial, sans-serif; background-color: #111; color: white; padding: 20px; text-align: center; max-width: 800px; margin: auto; border: 3px solid #333;">
  <div class="stream-box">
    <div style="position: absolute; top: 10px; left: 10px; background: red; padding: 5px 10px; font-weight: bold;">LIVE STREAM</div>
    <div id="stream-status">Trwa wczytywanie transmisji gali Prime MMA 12 PPV...</div>
  </div>
  <div id="viewer-count" style="margin: 15px 0; font-size: 18px; color: #0f0;">Oglądających: <span id="viewer">...</span></div>
  <div id="countdown" style="font-size: 24px; margin: 15px 0;">Oczekiwanie na połączenie: <span id="timer">--:--</span></div>
  <div id="message" style="display:none; font-size: 18px; color: red; margin: 10px 0;"></div>
  <div id="pre-message" style="display:none; font-size: 18px; color: yellow; margin: 10px 0;">Gala Prime MMA 12 jeszcze się nie rozpoczęła. Transmisja będzie dostępna od godziny 20:00.</div>
  <div id="options" style="display:none;">
    <p>Spróbuj innego źródła:</p>
    <button onclick="retry(1)" id="btn1">Źródło 1 - transmisja online (<span id='v1'>...</span>)</button>
    <button onclick="retry(2)" id="btn2">Źródło 2 - transmisja online (<span id='v2'>...</span>)</button>
    <button onclick="retry(3)" id="btn3">Źródło 3 - transmisja online (<span id='v3'>...</span>)</button>
    <button onclick="retry(4)" id="btn4">Źródło 4 - transmisja online (<span id='v4'>...</span>)</button>
  </div>
  <button onclick="location.reload()" style="margin-top: 20px; display:none;" id="refresh-btn">Odśwież stronę (F5)</button>
  <audio id="error-sound" src="https://www.soundjay.com/button/sounds/beep-07.mp3" preload="auto"></audio>
</div>

<script>
  const now = new Date();
  const currentHour = now.getHours();

  const viewerSpan = document.getElementById('viewer');
  const streamStatus = document.getElementById('stream-status');
  const countdownDiv = document.getElementById('countdown');
  const timerDisplay = document.getElementById('timer');
  const messageDiv = document.getElementById('message');
  const optionsDiv = document.getElementById('options');
  const refreshBtn = document.getElementById('refresh-btn');
  const errorSound = document.getElementById('error-sound');
  const preMessage = document.getElementById('pre-message');

  const errorMessages = [
    'Błąd połączenia ze źródłem. Spróbuj ponownie.',
    'Przeciążenie serwera. Oczekiwanie na wolne miejsce...',
    'Nieoczekiwany błąd. Proszę spróbować innego źródła.',
    'Źródło niedostępne. Wybierz inne lub odśwież stronę.'
  ];

  function showError() {
    const msg = errorMessages[Math.floor(Math.random() * errorMessages.length)];
    messageDiv.textContent = msg;
    messageDiv.style.display = 'block';
    optionsDiv.style.display = 'block';
    refreshBtn.style.display = 'inline-block';
    errorSound.play();

    document.getElementById('v1').textContent = Math.floor(Math.random() * (350 - 50 + 1)) + 50;
    document.getElementById('v2').textContent = Math.floor(Math.random() * (350 - 50 + 1)) + 50;
    document.getElementById('v3').textContent = Math.floor(Math.random() * (350 - 50 + 1)) + 50;
    document.getElementById('v4').textContent = Math.floor(Math.random() * (350 - 50 + 1)) + 50;
  }

  function retry(sourceNum) {
    streamStatus.textContent = `Próba połączenia ze źródłem ${sourceNum}...`;
    messageDiv.style.display = 'none';
    optionsDiv.style.display = 'none';
    refreshBtn.style.display = 'none';
    timeLeft = 10;
    startCountdown();
  }

  function startCountdown() {
    const interval = setInterval(() => {
      let minutes = Math.floor(timeLeft / 60);
      let seconds = timeLeft % 60;
      timerDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
      if (timeLeft <= 0) {
        clearInterval(interval);
        showError();
      }
      timeLeft--;
    }, 1000);
  }

  let timeLeft = 10;

  if (currentHour >= 20 && currentHour < 24) {
    viewerSpan.textContent = Math.floor(Math.random() * (1000 - 40 + 1)) + 40;
    startCountdown();
  } else {
    document.querySelector(".stream-box").style.display = "none";
    countdownDiv.style.display = 'none';
    preMessage.style.display = 'block';
    streamStatus.textContent = '';
  }
</script>
</body>
</html>
